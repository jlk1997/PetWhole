import{r as f,v as W,c as X,A as Z,b as ee,d as m,e as t,w as n,g as r,u as te,D as le,o as g,p as s,J as ne,i as _,t as z,f as ae,E as L,s as U}from"./index-BZUGXbIj.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const se={class:"users-container"},ie={class:"page-header"},re={class:"page-header-actions"},ue={class:"pagination-container"},de={class:"reset-form"},me={class:"dialog-footer"},pe={__name:"list",setup(ce){const E=te(),y=f(!1),b=f(!1),c=f(1),w=f(10),x=f(0),o=W({nickname:"",phone:"",status:"",registerTime:[]}),V=f({}),v=f([{id:1,nickname:"小狗爱好者",avatar:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",phone:"13800138000",email:"dog_lover@example.com",gender:"male",registerTime:"2023-10-15 09:30:15",lastLoginTime:"2023-11-18 14:25:30",status:"active",postCount:15,petCount:2,followCount:28,followerCount:36,bio:"热爱宠物，尤其是狗狗。拥有两只可爱的金毛，喜欢分享它们的日常。"},{id:2,nickname:"猫咪公主",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",phone:"13900139000",email:"cat_princess@example.com",gender:"female",registerTime:"2023-10-18 11:20:45",lastLoginTime:"2023-11-17 19:40:12",status:"active",postCount:23,petCount:3,followCount:45,followerCount:102,bio:"三只猫咪的铲屎官，喜欢拍摄猫咪的各种萌态。专业猫咪护理师，提供猫咪养护建议。"},{id:3,nickname:"宠物医生王",avatar:"https://cube.elemecdn.com/9/c2/f0ee8a3c7c9638a54940382568c9cpng.png",phone:"13700137000",email:"pet_doctor@example.com",gender:"male",registerTime:"2023-10-20 08:15:30",lastLoginTime:"2023-11-19 08:10:45",status:"active",postCount:42,petCount:1,followCount:146,followerCount:520,bio:"宠物医院医生，专业兽医。热爱分享宠物健康知识，为宠物主人提供专业建议。"},{id:4,nickname:"汪汪训练师",avatar:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",phone:"13600136000",email:"dog_trainer@example.com",gender:"unknown",registerTime:"2023-10-25 14:40:20",lastLoginTime:"2023-11-15 16:20:30",status:"active",postCount:31,petCount:4,followCount:89,followerCount:215,bio:"专业狗狗训练师，擅长行为矫正和技能培训。欢迎咨询各类犬类训练问题。"},{id:5,nickname:"宠物摄影师",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",phone:"13500135000",email:"pet_photo@example.com",gender:"female",registerTime:"2023-11-01 10:30:45",lastLoginTime:"2023-11-18 11:15:22",status:"disabled",postCount:18,petCount:0,followCount:67,followerCount:124,bio:"专业宠物摄影师，提供宠物写真服务。喜欢捕捉宠物最自然、最可爱的瞬间。"}]),M=X(()=>{let a=v.value;if(o.nickname&&(a=a.filter(u=>u.nickname.includes(o.nickname))),o.phone&&(a=a.filter(u=>u.phone.includes(o.phone))),o.status&&(a=a.filter(u=>u.status===o.status)),o.registerTime&&o.registerTime.length===2){const u=new Date(o.registerTime[0]),p=new Date(o.registerTime[1]);p.setHours(23,59,59,999),a=a.filter(k=>{const h=new Date(k.registerTime);return h>=u&&h<=p})}x.value=a.length;const e=(c.value-1)*w.value,i=e+w.value;return a.slice(e,i)});Z(()=>{B()});const B=()=>{y.value=!0,setTimeout(()=>{x.value=v.value.length,y.value=!1},500)},S=()=>{B()},C=()=>{c.value=1},I=()=>{o.nickname="",o.phone="",o.status="",o.registerTime=[],c.value=1},N=a=>{w.value=a,c.value=1},R=a=>{c.value=a},Y=a=>{E.push(`/users/detail/${a.id}`)},F=a=>{L.confirm(`确定要禁用用户 "${a.nickname}" 吗？禁用后该用户将无法登录。`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=v.value.findIndex(i=>i.id===a.id);e!==-1&&(v.value[e].status="disabled"),U.success("用户已禁用")}).catch(()=>{})},P=a=>{L.confirm(`确定要启用用户 "${a.nickname}" 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then(()=>{const e=v.value.findIndex(i=>i.id===a.id);e!==-1&&(v.value[e].status="active"),U.success("用户已启用")}).catch(()=>{})},j=a=>{V.value=a,b.value=!0},A=()=>{setTimeout(()=>{b.value=!1,U.success(`用户 ${V.value.nickname} 的密码已重置，新密码已通过短信发送`)},500)};return(a,e)=>{const i=r("el-button"),u=r("el-input"),p=r("el-form-item"),k=r("el-option"),h=r("el-select"),H=r("el-date-picker"),J=r("el-form"),$=r("el-card"),d=r("el-table-column"),q=r("el-avatar"),T=r("el-tag"),G=r("el-table"),K=r("el-pagination"),O=r("el-dialog"),Q=le("loading");return g(),ee("div",se,[m("div",ie,[e[9]||(e[9]=m("h2",null,"用户管理",-1)),m("div",re,[t(i,{type:"primary",onClick:S},{default:n(()=>e[8]||(e[8]=[s("刷新数据")])),_:1})])]),t($,{shadow:"hover",class:"filter-card"},{default:n(()=>[t(J,{inline:!0,model:o,class:"filter-form"},{default:n(()=>[t(p,{label:"用户昵称"},{default:n(()=>[t(u,{modelValue:o.nickname,"onUpdate:modelValue":e[0]||(e[0]=l=>o.nickname=l),placeholder:"输入用户昵称",clearable:"",onClear:C},null,8,["modelValue"])]),_:1}),t(p,{label:"手机号码"},{default:n(()=>[t(u,{modelValue:o.phone,"onUpdate:modelValue":e[1]||(e[1]=l=>o.phone=l),placeholder:"输入手机号码",clearable:"",onClear:C},null,8,["modelValue"])]),_:1}),t(p,{label:"账号状态"},{default:n(()=>[t(h,{modelValue:o.status,"onUpdate:modelValue":e[2]||(e[2]=l=>o.status=l),placeholder:"选择状态",clearable:"",onChange:C},{default:n(()=>[t(k,{label:"正常",value:"active"}),t(k,{label:"禁用",value:"disabled"})]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"注册时间"},{default:n(()=>[t(H,{modelValue:o.registerTime,"onUpdate:modelValue":e[3]||(e[3]=l=>o.registerTime=l),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD",onChange:C},null,8,["modelValue"])]),_:1}),t(p,null,{default:n(()=>[t(i,{type:"primary",onClick:C},{default:n(()=>e[10]||(e[10]=[s("查询")])),_:1}),t(i,{onClick:I},{default:n(()=>e[11]||(e[11]=[s("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t($,{shadow:"hover",class:"users-card"},{default:n(()=>[ne((g(),_(G,{data:M.value,style:{width:"100%"}},{default:n(()=>[t(d,{prop:"id",label:"ID",width:"80"}),t(d,{label:"头像",width:"100"},{default:n(l=>[t(q,{src:l.row.avatar,size:40},{default:n(()=>[s(z(l.row.nickname.substring(0,1)),1)]),_:2},1032,["src"])]),_:1}),t(d,{prop:"nickname",label:"用户昵称","min-width":"120"}),t(d,{prop:"phone",label:"手机号码",width:"150"}),t(d,{prop:"email",label:"电子邮箱",width:"180","show-overflow-tooltip":""}),t(d,{label:"性别",width:"80"},{default:n(l=>[l.row.gender==="unknown"?(g(),_(T,{key:0,type:"info"},{default:n(()=>e[12]||(e[12]=[s("未知")])),_:1})):l.row.gender==="male"?(g(),_(T,{key:1,type:"success"},{default:n(()=>e[13]||(e[13]=[s("男")])),_:1})):l.row.gender==="female"?(g(),_(T,{key:2,type:"danger"},{default:n(()=>e[14]||(e[14]=[s("女")])),_:1})):ae("",!0)]),_:1}),t(d,{prop:"registerTime",label:"注册时间",width:"180"}),t(d,{prop:"lastLoginTime",label:"最后登录",width:"180"}),t(d,{label:"状态",width:"100"},{default:n(l=>[t(T,{type:l.row.status==="active"?"success":"danger"},{default:n(()=>[s(z(l.row.status==="active"?"正常":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(d,{label:"操作",width:"250",fixed:"right"},{default:n(l=>[t(i,{size:"small",type:"primary",onClick:D=>Y(l.row)},{default:n(()=>e[15]||(e[15]=[s("查看")])),_:2},1032,["onClick"]),l.row.status==="active"?(g(),_(i,{key:0,size:"small",type:"danger",onClick:D=>F(l.row)},{default:n(()=>e[16]||(e[16]=[s("禁用")])),_:2},1032,["onClick"])):(g(),_(i,{key:1,size:"small",type:"success",onClick:D=>P(l.row)},{default:n(()=>e[17]||(e[17]=[s("启用")])),_:2},1032,["onClick"])),t(i,{size:"small",type:"warning",onClick:D=>j(l.row)},{default:n(()=>e[18]||(e[18]=[s("重置密码")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Q,y.value]]),m("div",ue,[t(K,{"current-page":c.value,"onUpdate:currentPage":e[4]||(e[4]=l=>c.value=l),"page-size":w.value,"onUpdate:pageSize":e[5]||(e[5]=l=>w.value=l),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:x.value,onSizeChange:N,onCurrentChange:R},null,8,["current-page","page-size","total"])])]),_:1}),t(O,{modelValue:b.value,"onUpdate:modelValue":e[7]||(e[7]=l=>b.value=l),title:"重置密码",width:"400px"},{footer:n(()=>[m("span",me,[t(i,{onClick:e[6]||(e[6]=l=>b.value=!1)},{default:n(()=>e[22]||(e[22]=[s("取消")])),_:1}),t(i,{type:"primary",onClick:A},{default:n(()=>e[23]||(e[23]=[s("确定重置")])),_:1})])]),default:n(()=>[m("div",de,[m("p",null,[e[19]||(e[19]=s("确定要重置用户 ")),m("strong",null,z(V.value.nickname),1),e[20]||(e[20]=s(" 的密码吗？"))]),e[21]||(e[21]=m("p",null,"重置后将生成随机密码并通过短信发送给用户。",-1))])]),_:1},8,["modelValue"])])}}},ve=oe(pe,[["__scopeId","data-v-f0595fec"]]);export{ve as default};
