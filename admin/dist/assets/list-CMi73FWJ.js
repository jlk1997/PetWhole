import{r as g,v as M,A as N,b as T,d as f,e,w as o,g as r,s as p,D as K,o as C,x as j,p as i,J as q,i as I,t as b,E as J}from"./index-BZUGXbIj.js";import{g as Q,d as F}from"./index-DMQPIv9t.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-xsH4HHeE.js";const H={class:"pet-list-container"},O={class:"pagination-container"},R={__name:"list",setup(W){const m=g(!1),v=g([]),w=g(0),l=M({page:1,limit:10,search:"",breed:""}),x=n=>n?new Date(n).toLocaleString():"-",d=async()=>{var n;m.value=!0;try{const t=await Q("/api/pets",l);v.value=t.data||[],w.value=((n=t.pagination)==null?void 0:n.total)||0}catch(t){console.error("获取宠物列表失败:",t),p.error("获取宠物列表失败")}finally{m.value=!1}},y=()=>{l.page=1,d()},k=()=>{l.search="",l.breed="",l.page=1,d()},z=n=>{l.limit=n,d()},V=n=>{l.page=n,d()},D=n=>{p.info(`查看宠物详情: ${n.name}`)},B=n=>{J.confirm(`确定要删除宠物 ${n.name} 吗？此操作不可逆`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await F(`/api/pets/${n._id}`),p.success("删除成功"),d()}catch(t){console.error("删除宠物失败:",t),p.error("删除失败")}}).catch(()=>{p.info("已取消删除")})};return N(()=>{d()}),(n,t)=>{const P=r("el-input"),_=r("el-form-item"),c=r("el-option"),$=r("el-select"),u=r("el-button"),S=r("el-form"),h=r("el-card"),s=r("el-table-column"),E=r("el-table"),U=r("el-pagination"),A=K("loading");return C(),T("div",H,[t[8]||(t[8]=f("div",{class:"page-header"},[f("h2",null,"宠物列表")],-1)),e(h,{class:"filter-card"},{default:o(()=>[e(S,{inline:!0,model:l,class:"filter-form"},{default:o(()=>[e(_,{label:"搜索"},{default:o(()=>[e(P,{modelValue:l.search,"onUpdate:modelValue":t[0]||(t[0]=a=>l.search=a),placeholder:"宠物名称/品种/主人",clearable:"",onKeyup:j(y,["enter"])},null,8,["modelValue"])]),_:1}),e(_,{label:"品种"},{default:o(()=>[e($,{modelValue:l.breed,"onUpdate:modelValue":t[1]||(t[1]=a=>l.breed=a),placeholder:"选择品种",clearable:""},{default:o(()=>[e(c,{label:"全部",value:""}),e(c,{label:"拉布拉多",value:"拉布拉多"}),e(c,{label:"金毛",value:"金毛"}),e(c,{label:"哈士奇",value:"哈士奇"}),e(c,{label:"边牧",value:"边牧"}),e(c,{label:"其他",value:"其他"})]),_:1},8,["modelValue"])]),_:1}),e(_,null,{default:o(()=>[e(u,{type:"primary",onClick:y},{default:o(()=>t[4]||(t[4]=[i("搜索")])),_:1}),e(u,{onClick:k},{default:o(()=>t[5]||(t[5]=[i("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(h,{class:"table-card"},{default:o(()=>[q((C(),I(E,{data:v.value,style:{width:"100%"},border:""},{default:o(()=>[e(s,{type:"index",width:"50",align:"center"}),e(s,{prop:"name",label:"宠物名称",width:"150"}),e(s,{prop:"breed",label:"品种",width:"150"}),e(s,{prop:"gender",label:"性别",width:"80"},{default:o(a=>[i(b(a.row.gender==="male"?"公":a.row.gender==="female"?"母":"未知"),1)]),_:1}),e(s,{prop:"age",label:"年龄",width:"80"},{default:o(a=>[i(b(a.row.age?`${a.row.age}岁`:"未知"),1)]),_:1}),e(s,{prop:"owner.nickname",label:"主人",width:"120"}),e(s,{prop:"createdAt",label:"创建时间",width:"180"},{default:o(a=>[i(b(x(a.row.createdAt)),1)]),_:1}),e(s,{label:"操作",align:"center"},{default:o(a=>[e(u,{size:"small",type:"primary",onClick:L=>D(a.row)},{default:o(()=>t[6]||(t[6]=[i(" 查看 ")])),_:2},1032,["onClick"]),e(u,{size:"small",type:"danger",onClick:L=>B(a.row)},{default:o(()=>t[7]||(t[7]=[i(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[A,m.value]]),f("div",O,[e(U,{currentPage:l.page,"onUpdate:currentPage":t[2]||(t[2]=a=>l.page=a),"page-size":l.limit,"onUpdate:pageSize":t[3]||(t[3]=a=>l.limit=a),"page-sizes":[10,20,50,100],total:w.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:z,onCurrentChange:V},null,8,["currentPage","page-size","total"])])]),_:1})])}}},te=G(R,[["__scopeId","data-v-e66f6eb7"]]);export{te as default};
