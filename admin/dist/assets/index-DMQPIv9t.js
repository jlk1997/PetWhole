import{a as i}from"./index-xsH4HHeE.js";import{s as o,X as n}from"./index-BZUGXbIj.js";const r=i.create({baseURL:"http://49.235.65.37:5001",timeout:3e4,headers:{"Content-Type":"application/json;charset=utf-8"}});r.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>(console.error("请求错误:",e),Promise.reject(e)));r.interceptors.response.use(e=>{const t=e.data;return t.code!==void 0&&t.code!==0?(o({message:t.message||"接口请求失败",type:"error",duration:5*1e3}),t.code===401&&c(),Promise.reject(new Error(t.message||"接口请求失败"))):t},e=>{if(console.error("响应错误:",e),e.response){const t=e.response.status;let s=e.response.data.message||"服务器错误";t===401?s="未授权，请重新登录":t===403?s="拒绝访问":t===404?s="请求的资源不存在":t===500&&(s="服务器错误"),o({message:s,type:"error",duration:5*1e3})}else e.message.includes("timeout")?o({message:"请求超时，请稍后重试",type:"error",duration:5*1e3}):o({message:"网络错误，请检查您的网络连接",type:"error",duration:5*1e3});return Promise.reject(e)});function c(){localStorage.removeItem("token"),localStorage.removeItem("user"),n.currentRoute.value.path!=="/login"&&n.push(`/login?redirect=${n.currentRoute.value.fullPath}`)}function m(e,t){return r.get(e,{params:t})}function d(e,t){return r.post(e,t)}function f(e,t){return r.put(e,t)}function g(e){return r.delete(e)}function h(e,t,a={}){const s=new FormData;s.append("file",t);for(const u in a)s.append(u,a[u]);return r.post(e,s,{headers:{"Content-Type":"multipart/form-data"}})}export{f as a,g as d,m as g,d as p,h as u};
