import{r as y,v as H,A as K,b as m,d as t,J as Q,e as o,w as s,g as _,D as W,i as C,a as X,u as Y,o as r,p as u,f as x,t as c,F as B,h as V,E as D,s as k}from"./index-BZUGXbIj.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ee={class:"post-detail-container"},te={class:"page-header"},se={class:"page-header-actions"},ne={class:"post-header"},oe={class:"post-title"},ae={class:"post-meta"},le={class:"post-author"},ie={class:"post-time"},ce={class:"post-content"},de={key:0,class:"post-images"},re={class:"image-list"},ue={class:"post-stats"},pe={class:"post-actions"},me={class:"comments-header"},_e={key:0,class:"no-comments"},ve={key:1,class:"comment-list"},fe={class:"comment-user"},he=["src"],ge={class:"comment-info"},be={class:"comment-author"},ye={class:"comment-time"},ke={class:"comment-content"},Ce={class:"comment-actions"},xe={key:0,class:"reply-list"},we={class:"comment-user"},Te=["src"],Be={class:"comment-info"},Ve={class:"comment-author"},De={class:"comment-time"},$e={class:"comment-content"},Ie={class:"comment-actions"},Re={class:"dialog-footer"},Se={__name:"detail",setup(Ee){const E=X(),N=Y(),w=y(!1),h=y(!1),g=y(""),b=y(null),a=H({id:0,title:"",content:"",author:"",createTime:"",viewCount:0,likeCount:0,commentCount:0,status:"",images:[]}),v=y([]),M=()=>E.params.id,$=()=>{w.value=!0;const i=M();setTimeout(()=>{Object.assign(a,{id:i,title:"我家狗狗今天好可爱",content:`今天带我家金毛出去玩，它特别开心，还交到了新朋友。我们去了新开的宠物公园，那里的设施很完善，有专门的狗狗游乐区和休息区。

我家金毛一到那里就兴奋得不得了，到处跑来跑去，还和其他几只狗狗一起玩耍。看到它这么开心，我也特别高兴。

希望以后能有更多这样的宠物友好场所，让我们的毛孩子有更好的社交和玩耍环境。`,author:"狗狗爱好者",createTime:"2023-10-15 09:30:45",viewCount:235,likeCount:42,commentCount:3,status:"published",images:["https://images.unsplash.com/photo-1546527868-ccb7ee7dfa6a","https://images.unsplash.com/photo-1551717743-49959800b1f6"]}),v.value=[{id:1,author:"猫咪控",avatar:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",content:"好可爱的狗狗，我家猫看到肯定会躲起来哈哈",createTime:"2023-10-15 10:15:22",replies:[]},{id:2,author:"宠物医生",avatar:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",content:"金毛是很活泼的品种，需要多运动，带出去玩是很好的选择",createTime:"2023-10-15 11:30:45",replies:[{id:4,author:"狗狗爱好者",avatar:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",content:"谢谢医生的建议，我每天都会带它出去散步",createTime:"2023-10-15 12:05:18"}]},{id:3,author:"遛狗达人",avatar:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",content:"这个公园在哪里啊？也想带我家狗狗去",createTime:"2023-10-15 14:22:37",replies:[]}],w.value=!1},500)},F=()=>{$()},L=i=>{switch(i){case"published":return"success";case"pending":return"warning";case"disabled":return"danger";default:return"info"}},P=i=>{switch(i){case"published":return"已发布";case"pending":return"待审核";case"disabled":return"已禁用";default:return"未知"}},I=(i,e)=>{const l=e==="published"?"发布":"禁用";D.confirm(`确定要${l}该帖子吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:e==="published"?"success":"warning"}).then(()=>{i.status=e,k.success(`帖子已${l}`)}).catch(()=>{})},U=()=>{D.confirm("确定要删除该帖子吗？删除后无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{k.success("帖子已删除"),N.push("/posts/list")}).catch(()=>{})},j=i=>{b.value=i,g.value="",h.value=!0},A=()=>{if(!g.value.trim()){k.warning("请输入回复内容");return}b.value&&(b.value.replies||(b.value.replies=[]),b.value.replies.push({id:Date.now(),author:"管理员",avatar:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",content:g.value,createTime:new Date().toLocaleString()}),k.success("回复成功"),h.value=!1)},R=i=>{D.confirm("确定要删除该评论吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e=!1,l=null;for(const d of v.value){if(d.id===i.id)break;if(d.replies&&d.replies.findIndex(T=>T.id===i.id)!==-1){e=!0,l=d;break}}if(e&&l){const d=l.replies.findIndex(f=>f.id===i.id);l.replies.splice(d,1)}else{const d=v.value.findIndex(f=>f.id===i.id);d!==-1&&v.value.splice(d,1)}k.success("评论已删除")}).catch(()=>{})};return K(()=>{$()}),(i,e)=>{const l=_("el-button"),d=_("el-tag"),f=_("el-divider"),T=_("el-image"),S=_("el-card"),J=_("el-input"),O=_("el-form-item"),q=_("el-form"),z=_("el-dialog"),G=W("loading");return r(),m("div",ee,[t("div",te,[e[8]||(e[8]=t("h2",null,"帖子详情",-1)),t("div",se,[o(l,{onClick:e[0]||(e[0]=n=>i.$router.back())},{default:s(()=>e[6]||(e[6]=[u("返回")])),_:1}),o(l,{type:"primary",onClick:F},{default:s(()=>e[7]||(e[7]=[u("刷新")])),_:1})])]),Q((r(),C(S,{shadow:"hover",class:"post-card"},{default:s(()=>[t("div",ne,[t("h3",oe,c(a.title),1),t("div",ae,[t("span",le,"作者: "+c(a.author),1),t("span",ie,"发布时间: "+c(a.createTime),1),o(d,{type:L(a.status),class:"post-status"},{default:s(()=>[u(c(P(a.status)),1)]),_:1},8,["type"])])]),o(f),t("div",ce,[t("p",null,c(a.content),1)]),a.images&&a.images.length?(r(),m("div",de,[e[9]||(e[9]=t("h4",null,"附图",-1)),t("div",re,[(r(!0),m(B,null,V(a.images,(n,p)=>(r(),C(T,{key:p,src:n,"preview-src-list":a.images,fit:"cover",class:"post-image"},null,8,["src","preview-src-list"]))),128))])])):x("",!0),t("div",ue,[o(d,{type:"info"},{default:s(()=>[u("浏览 "+c(a.viewCount),1)]),_:1}),o(d,{type:"success"},{default:s(()=>[u("点赞 "+c(a.likeCount),1)]),_:1}),o(d,{type:"warning"},{default:s(()=>[u("评论 "+c(a.commentCount),1)]),_:1})]),o(f),t("div",pe,[a.status!=="published"?(r(),C(l,{key:0,type:"success",onClick:e[1]||(e[1]=n=>I(a,"published"))},{default:s(()=>e[10]||(e[10]=[u("发布")])),_:1})):x("",!0),a.status!=="disabled"?(r(),C(l,{key:1,type:"danger",onClick:e[2]||(e[2]=n=>I(a,"disabled"))},{default:s(()=>e[11]||(e[11]=[u("禁用")])),_:1})):x("",!0),o(l,{type:"warning",onClick:U},{default:s(()=>e[12]||(e[12]=[u("删除")])),_:1})])]),_:1})),[[G,w.value]]),o(S,{shadow:"hover",class:"comments-card"},{header:s(()=>[t("div",me,[t("h3",null,"评论列表 ("+c(v.value.length)+")",1)])]),default:s(()=>[v.value.length===0?(r(),m("div",_e," 暂无评论 ")):(r(),m("div",ve,[(r(!0),m(B,null,V(v.value,n=>(r(),m("div",{key:n.id,class:"comment-item"},[t("div",fe,[t("img",{src:n.avatar,class:"comment-avatar"},null,8,he),t("div",ge,[t("div",be,c(n.author),1),t("div",ye,c(n.createTime),1)])]),t("div",ke,c(n.content),1),t("div",Ce,[o(l,{type:"text",onClick:p=>j(n)},{default:s(()=>e[13]||(e[13]=[u("回复")])),_:2},1032,["onClick"]),o(l,{type:"text",onClick:p=>R(n)},{default:s(()=>e[14]||(e[14]=[u("删除")])),_:2},1032,["onClick"])]),n.replies&&n.replies.length?(r(),m("div",xe,[(r(!0),m(B,null,V(n.replies,p=>(r(),m("div",{key:p.id,class:"reply-item"},[t("div",we,[t("img",{src:p.avatar,class:"comment-avatar"},null,8,Te),t("div",Be,[t("div",Ve,c(p.author),1),t("div",De,c(p.createTime),1)])]),t("div",$e,c(p.content),1),t("div",Ie,[o(l,{type:"text",onClick:Ne=>R(p)},{default:s(()=>e[15]||(e[15]=[u("删除")])),_:2},1032,["onClick"])])]))),128))])):x("",!0)]))),128))]))]),_:1}),o(z,{modelValue:h.value,"onUpdate:modelValue":e[5]||(e[5]=n=>h.value=n),title:"回复评论",width:"500px"},{footer:s(()=>[t("span",Re,[o(l,{onClick:e[4]||(e[4]=n=>h.value=!1)},{default:s(()=>e[16]||(e[16]=[u("取消")])),_:1}),o(l,{type:"primary",onClick:A},{default:s(()=>e[17]||(e[17]=[u("回复")])),_:1})])]),default:s(()=>[o(q,null,{default:s(()=>[o(O,{label:"回复内容"},{default:s(()=>[o(J,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=n=>g.value=n),type:"textarea",rows:"4",placeholder:"请输入回复内容"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},Le=Z(Se,[["__scopeId","data-v-a57fa2aa"]]);export{Le as default};
