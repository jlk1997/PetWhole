import{n as P}from"./story-C7UPQB8y.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b as l,d as n,J as V,e as v,w as d,g as c,D as H,i as T,s as F,o as s,p as o,f as u,t as i,F as a,h as K}from"./index-BZUGXbIj.js";import"./index-xsH4HHeE.js";const W={name:"EventDetail",data(){return{loading:!1,eventId:null,event:{},chapterId:null,allEvents:[]}},created(){this.eventId=this.$route.params.id,this.eventId&&this.fetchData()},methods:{fetchData(){this.loading=!0,P(this.eventId).then(r=>{this.event=r.data,this.chapterId=this.event.chapterId,this.loading=!1}).catch(()=>{this.loading=!1,F.error("获取事件信息失败")})},goBack(){this.$router.push(`/story/chapters/${this.chapterId}`)},handleEdit(){this.$router.push(`/story/chapters/${this.chapterId}`)},getEventTypeTag(r){return{DIALOG:"primary",TASK:"success",GUIDE:"warning",REWARD:"danger",MULTI_CHOICE:"info"}[r]||"info"},getEventTypeName(r){return{DIALOG:"对话",TASK:"任务",GUIDE:"引导",REWARD:"奖励",MULTI_CHOICE:"多选"}[r]||r},getTriggerTypeName(r){return{AUTO:"自动",ENTER_PAGE:"进入页面",CLICK_ELEMENT:"点击元素",COMPLETE_TASK:"完成任务",MANUAL:"手动"}[r]||r},getTriggerTypeDesc(r){return{AUTO:"自动触发事件",ENTER_PAGE:"进入指定页面时触发",CLICK_ELEMENT:"点击指定元素时触发",COMPLETE_TASK:"完成特定任务时触发",MANUAL:"由用户手动触发"}[r]||"未知触发条件"},getEventTitleById(r){return r?`事件ID: ${r}`:"无"}}},j={class:"app-container"},q={class:"filter-container"},J={class:"card-header"},z={class:"event-info"},Q={key:0},X={key:1},Y={key:2},Z={key:0},$={class:"dialog-speaker"},ee={class:"dialog-content"},te={key:1,class:"no-content"},ne={key:4},se={key:0},oe={class:"choice-number"},ie={class:"choice-text"},le={class:"choice-next"},re={key:1,class:"no-content"};function de(r,e,ge,ve,t,g){const f=c("el-button"),E=c("el-tag"),_=c("el-divider"),R=c("el-tooltip"),b=c("el-card"),w=H("loading");return s(),l("div",j,[n("div",q,[v(f,{class:"filter-item",type:"primary",onClick:g.goBack},{default:d(()=>e[0]||(e[0]=[o(" 返回章节 ")])),_:1},8,["onClick"]),v(f,{class:"filter-item",type:"success",onClick:g.handleEdit},{default:d(()=>e[1]||(e[1]=[o(" 编辑事件 ")])),_:1},8,["onClick"])]),V((s(),T(b,{class:"box-card"},{header:d(()=>[n("div",J,[n("span",null,i(t.event.title||"事件详情"),1),n("div",null,[v(E,{type:g.getEventTypeTag(t.event.eventType)},{default:d(()=>[o(i(g.getEventTypeName(t.event.eventType)),1)]),_:1},8,["type"]),t.event.isActive?(s(),T(E,{key:0,type:"success",class:"ml-2"},{default:d(()=>e[2]||(e[2]=[o("已激活")])),_:1})):(s(),T(E,{key:1,type:"info",class:"ml-2"},{default:d(()=>e[3]||(e[3]=[o("未激活")])),_:1}))])])]),default:d(()=>{var m,I,C,k,h,A,D,L,N,M,O,x,U,B,G;return[n("div",z,[n("p",null,[e[4]||(e[4]=n("strong",null,"排序：",-1)),o(" "+i(t.event.sortOrder),1)]),v(_,{"content-position":"left"},{default:d(()=>e[5]||(e[5]=[o("触发条件")])),_:1}),n("p",null,[e[7]||(e[7]=n("strong",null,"触发类型：",-1)),o(" "+i(g.getTriggerTypeName((m=t.event.triggerCondition)==null?void 0:m.type))+" ",1),v(R,{content:g.getTriggerTypeDesc((I=t.event.triggerCondition)==null?void 0:I.type),placement:"top"},{default:d(()=>e[6]||(e[6]=[n("i",{class:"el-icon-question"},null,-1)])),_:1},8,["content"])]),((C=t.event.triggerCondition)==null?void 0:C.type)==="ENTER_PAGE"?(s(),l("p",Q,[e[8]||(e[8]=n("strong",null,"目标页面：",-1)),o(" "+i(t.event.triggerCondition.pageId),1)])):u("",!0),((k=t.event.triggerCondition)==null?void 0:k.type)==="CLICK_ELEMENT"?(s(),l("p",X,[e[9]||(e[9]=n("strong",null,"目标元素：",-1)),o(" "+i(t.event.triggerCondition.elementId),1)])):u("",!0),((h=t.event.triggerCondition)==null?void 0:h.type)!=="MANUAL"?(s(),l("p",Y,[e[10]||(e[10]=n("strong",null,"延迟时间：",-1)),o(" "+i(((A=t.event.triggerCondition)==null?void 0:A.delay)||0)+"毫秒",1)])):u("",!0),v(_,{"content-position":"left"},{default:d(()=>e[11]||(e[11]=[o("事件内容")])),_:1}),t.event.eventType==="DIALOG"?(s(),l(a,{key:3},[(D=t.event.content)!=null&&D.dialogues&&t.event.content.dialogues.length>0?(s(),l("div",Z,[(s(!0),l(a,null,K(t.event.content.dialogues,(p,y)=>(s(),l("div",{key:y,class:"dialog-preview"},[n("div",$,i(p.speaker),1),n("div",ee,i(p.content),1)]))),128))])):(s(),l("p",te,"没有设置对话内容"))],64)):u("",!0),t.event.eventType==="TASK"?(s(),l("p",ne,[e[12]||(e[12]=n("strong",null,"任务目标：",-1)),o(" "+i(((L=t.event.content)==null?void 0:L.taskObjective)||"未设置任务目标"),1)])):u("",!0),t.event.eventType==="GUIDE"?(s(),l(a,{key:5},[n("p",null,[e[13]||(e[13]=n("strong",null,"目标页面：",-1)),o(" "+i(((M=(N=t.event.content)==null?void 0:N.guideInfo)==null?void 0:M.targetPage)||"未设置"),1)]),n("p",null,[e[14]||(e[14]=n("strong",null,"目标元素：",-1)),o(" "+i(((x=(O=t.event.content)==null?void 0:O.guideInfo)==null?void 0:x.targetElement)||"未设置"),1)]),n("p",null,[e[15]||(e[15]=n("strong",null,"引导文本：",-1)),o(" "+i(((B=(U=t.event.content)==null?void 0:U.guideInfo)==null?void 0:B.guideText)||"未设置引导文本"),1)])],64)):u("",!0),t.event.eventType==="MULTI_CHOICE"?(s(),l(a,{key:6},[(G=t.event.content)!=null&&G.choices&&t.event.content.choices.length>0?(s(),l("div",se,[e[16]||(e[16]=n("p",null,[n("strong",null,"选项：")],-1)),(s(!0),l(a,null,K(t.event.content.choices,(p,y)=>(s(),l("div",{key:y,class:"choice-preview"},[n("div",oe,"选项 "+i(y+1)+":",1),n("div",ie,i(p.text),1),n("div",le," 下一个事件: "+i(g.getEventTitleById(p.nextEventId)||"未设置"),1)]))),128))])):(s(),l("p",re,"没有设置选项内容"))],64)):u("",!0),v(_,{"content-position":"left"},{default:d(()=>e[17]||(e[17]=[o("流程控制")])),_:1}),n("p",null,[e[18]||(e[18]=n("strong",null,"下一个事件：",-1)),o(" "+i(g.getEventTitleById(t.event.nextEventId)||"未设置下一个事件"),1)])])]}),_:1})),[[w,t.loading]])])}const ye=S(W,[["render",de],["__scopeId","data-v-3f00a46f"]]);export{ye as default};
