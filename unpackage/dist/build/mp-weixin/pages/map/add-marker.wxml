<view class="marker-form-container"><view class="form-header"><text class="form-title">添加地图标记/故事</text></view><view class="form-content"><view class="form-item"><text class="form-label">标记标题<text class="required">*</text></text><input class="form-input" type="text" placeholder="请输入标记标题" maxlength="50" value="{{a}}" bindinput="{{b}}"/></view><view class="form-item"><text class="form-label">标记描述</text><block wx:if="{{r0}}"><textarea class="form-textarea" placeholder="请输入标记描述" maxlength="200" value="{{c}}" bindinput="{{d}}"/></block></view><view class="form-item"><text class="form-label">上传图片</text><view class="image-upload-area"><view wx:if="{{e}}" class="upload-button" bindtap="{{g}}"><uni-icons wx:if="{{f}}" u-i="398ef52c-0" bind:__l="__l" u-p="{{f}}"></uni-icons><text class="upload-text">点击上传图片</text></view><uni-file-picker wx:if="{{l}}" class="r" u-r="filePicker" bindselect="{{i}}" binddelete="{{j}}" u-i="398ef52c-1" bind:__l="__l" bindupdateModelValue="{{k}}" u-p="{{l}}"></uni-file-picker><view wx:if="{{m}}" class="uploaded-images"><view wx:for="{{n}}" wx:for-item="img" wx:key="g" class="image-item"><image src="{{img.a}}" mode="aspectFill" class="preview-image" bindtap="{{img.b}}"></image><input type="text" placeholder="请输入图片描述(可选)" class="image-caption-input" value="{{img.c}}" bindinput="{{img.d}}"/><view class="image-actions"><view class="delete-btn" bindtap="{{img.f}}"><uni-icons wx:if="{{o}}" u-i="{{img.e}}" bind:__l="__l" u-p="{{o}}"></uni-icons></view></view></view><view wx:if="{{p}}" class="add-more-btn" bindtap="{{r}}"><uni-icons wx:if="{{q}}" u-i="398ef52c-3" bind:__l="__l" u-p="{{q}}"></uni-icons><text>添加更多图片</text></view></view></view></view><view class="form-item"><text class="form-label">标记类型</text><view class="marker-type-selector"><view wx:for="{{s}}" wx:for-item="type" wx:key="f" class="{{['marker-type-item', type.g && 'active']}}" bindtap="{{type.h}}"><view class="marker-type-icon" style="{{'background-color:' + type.d}}"><image wx:if="{{type.a}}" src="{{type.b}}" class="type-icon" mode="aspectFit"></image><image wx:else src="{{type.c}}" class="type-icon svg-icon" mode="aspectFit"></image></view><text class="marker-type-label">{{type.e}}</text></view></view></view><view wx:if="{{t}}" class="form-item"><text class="form-label">自定义类型名称</text><input class="form-input" type="text" placeholder="请输入自定义类型名称" maxlength="20" value="{{v}}" bindinput="{{w}}"/></view><view class="form-item"><text class="form-label">标记颜色</text><view class="color-selector"><view wx:for="{{x}}" wx:for-item="color" wx:key="a" style="{{'background-color:' + color.b}}" class="{{['color-item', color.c && 'active']}}" bindtap="{{color.d}}"></view></view></view><view class="form-item"><text class="form-label">覆盖半径 (千米)</text><slider class="radius-slider" min="{{0.1}}" max="{{10}}" step="{{0.1}}" value="{{y}}" show-value="{{true}}" bindchange="{{z}}"/><text class="radius-value">{{A}}km</text></view><view class="form-item checkbox-item"><checkbox checked="{{B}}" bindtap="{{C}}"/><text class="checkbox-label">公开此标记（允许其他用户看到）</text></view><view wx:if="{{D}}" class="form-item"><text class="form-label">关联宠物</text><picker class="form-picker" range="{{F}}" range-key="name" bindchange="{{G}}"><view class="picker-value">{{E}}</view></picker></view><view class="form-location"><text class="location-label">位置信息</text><view class="location-info"><text class="location-coordinates">经度: {{H}}, 纬度: {{I}}</text><text class="location-hint">点击下方地图可直接标记位置，或拖动标记点调整位置</text></view><view class="location-map"><map id="marker-preview-map" class="mini-map" latitude="{{J}}" longitude="{{K}}" markers="{{L}}" circles="{{M}}" scale="16" bindtap="{{N}}" bindmarkerdrag="{{O}}" show-location></map><view class="map-overlay-tips"><text>点击地图任意位置 或 长按标记进行拖动</text></view><view class="map-controls"><view class="map-control-btn" bindtap="{{P}}"><text class="map-control-text">定位到标记</text></view></view></view></view></view><view class="form-actions"><button class="btn btn-cancel" bindtap="{{Q}}">取消</button><button class="btn btn-submit" bindtap="{{R}}">保存</button></view></view>